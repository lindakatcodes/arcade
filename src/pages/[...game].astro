---
import { getCollection } from "astro:content";
import GamePage from "@layouts/GamePage.astro";

export async function getStaticPaths() {
  const games = await getCollection("games");
  return games.map((game) => {
    return {
      params: { game: game.id },
      props: { gameId: game.id, game, scriptSrc: game.data.scriptName },
    };
  });
}

const { game, gameId, scriptSrc } = Astro.props;
const fileName = game.data.title.replaceAll(" ", "");
const GameComponent = await import(`../components/${fileName}.astro`);
---

<GamePage title={game.data.title} gameId={gameId} scriptSrc={scriptSrc}>
  <GameComponent.default />
</GamePage>
